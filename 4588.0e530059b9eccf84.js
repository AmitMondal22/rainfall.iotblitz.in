"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[4588],{4588:(I,h,d)=>{d.r(h),d.d(h,{GraphicalViewModule:()=>D});var p=d(6814),o=d(95),c=d(7398),a=d(4769),f=d(8814);let m=(()=>{var r;class s{constructor(e,t){this.api=e,this.datePipe=t,this.device=[],this.filtered_device=[],this.md_temparature=[],this.md_solar_radiation=[],this.md_atm_pressure=[],this.md_humidity=[],this.md_wind_speed=[],this.md_wind_direction=[],this.md_rainfall=[],this.device_form=new o.cw({device:new o.NI(null)}),this.graph_date_form=new o.cw({temparature:new o.cw({start_date:new o.NI(new Date)}),rainfall:new o.cw({start_date:new o.NI(new Date)}),atm_pressure:new o.cw({start_date:new o.NI(new Date)}),solar_radiation:new o.cw({start_date:new o.NI(new Date)}),humidity:new o.cw({start_date:new o.NI(new Date)}),wind_speed:new o.cw({start_date:new o.NI(new Date)}),wind_dir:new o.cw({start_date:new o.NI(new Date)})}),this.getDeviceList=()=>{const i=Number(localStorage.getItem("c_id"));this.api.call_api(1,"client/devices/list",{client_id:i}).pipe((0,c.U)(n=>n.data)).subscribe(n=>{this.device=n,this.device_form.get("device").setValue(n[0]),setTimeout(()=>{this.call_api_for_fillup_data_in_chart()},1e3)})},this.call_api_for_fillup_data_in_chart=()=>{this.get_temparature_data(this.graph_date_form.get(["temparature","start_date"]).value),this.get_solar_radiation_data(this.graph_date_form.get(["solar_radiation","start_date"]).value),this.get_rainfall_data(this.graph_date_form.get(["rainfall","start_date"]).value),this.get_atm_pressure_data(this.graph_date_form.get(["atm_pressure","start_date"]).value),this.get_humidity_data(this.graph_date_form.get(["humidity","start_date"]).value),this.get_wind_speed_data(this.graph_date_form.get(["wind_speed","start_date"]).value),this.get_wind_direction_data(this.graph_date_form.get(["wind_dir","start_date"]).value)}}ngOnInit(){this.getDeviceList()}filterDevice(e){this.filtered_device=[];const t=e.query;this.filtered_device=this.device.filter(i=>0==i.device.toLowerCase().indexOf(t.toLowerCase()))}ngAfterViewInit(){this.graph_date_form.get(["temparature","start_date"]).valueChanges.subscribe(e=>{this.get_temparature_data(e)}),this.graph_date_form.get(["rainfall","start_date"]).valueChanges.subscribe(e=>{this.get_rainfall_data(e)}),this.graph_date_form.get(["atm_pressure","start_date"]).valueChanges.subscribe(e=>{this.get_atm_pressure_data(e)}),this.graph_date_form.get(["solar_radiation","start_date"]).valueChanges.subscribe(e=>{this.get_solar_radiation_data(e)}),this.graph_date_form.get(["humidity","start_date"]).valueChanges.subscribe(e=>{this.get_humidity_data(e)}),this.graph_date_form.get(["wind_speed","start_date"]).valueChanges.subscribe(e=>{this.get_wind_speed_data(e)}),this.graph_date_form.get(["wind_dir","start_date"]).valueChanges.subscribe(e=>{this.get_wind_direction_data(e)})}get_payload(e){return new Promise((t,i)=>{if(this.device_form.value.device){const n={...this.device_form.value.device,start_date:this.datePipe.transform(e,"YYYY-MM-dd")};try{t(n)}catch{i(null)}}else i(null)})}setDevice(){console.log("sss"),this.call_api_for_fillup_data_in_chart()}get_temparature_data(e){this.get_payload(e).then(t=>{this.api.call_api(1,"client/devices/graphical_view/temperature",t).pipe((0,c.U)(i=>i.data)).subscribe(i=>{this.md_temparature=i})},t=>{})}get_solar_radiation_data(e){this.get_payload(e).then(t=>{this.api.call_api(1,"client/devices/graphical_view/solar_radiation",t).pipe((0,c.U)(i=>i.data)).subscribe(i=>{this.md_solar_radiation=i})},t=>{})}get_rainfall_data(e){this.get_payload(e).then(t=>{this.api.call_api(1,"client/devices/graphical_view/rainfall",t).pipe((0,c.U)(i=>i.data)).subscribe(i=>{this.md_rainfall=i})},t=>{})}get_atm_pressure_data(e){this.get_payload(e).then(t=>{this.api.call_api(1,"client/devices/graphical_view/atm_pressure",t).pipe((0,c.U)(i=>i.data)).subscribe(i=>{this.md_atm_pressure=i})},t=>{})}get_humidity_data(e){this.get_payload(e).then(t=>{this.api.call_api(1,"client/devices/graphical_view/humidity",t).pipe((0,c.U)(i=>i.data)).subscribe(i=>{this.md_humidity=i})},t=>{})}get_wind_direction_data(e){this.get_payload(e).then(t=>{this.api.call_api(1,"client/devices/graphical_view/wind_direction",t).pipe((0,c.U)(i=>i.data)).subscribe(i=>{this.md_wind_direction=i})},t=>{})}get_wind_speed_data(e){this.get_payload(e).then(t=>{this.api.call_api(1,"client/devices/graphical_view/wind_speed",t).pipe((0,c.U)(i=>i.data)).subscribe(i=>{this.md_wind_speed=i})},t=>{})}}return(r=s).\u0275fac=function(e){return new(e||r)(a.Y36(f.s),a.Y36(p.uU))},r.\u0275cmp=a.Xpm({type:r,selectors:[["app-graphical-view"]],decls:16,vars:8,consts:[[1,"card","flex","justify-content-end","py-2","px-1","rounded-sm"],[3,"formGroup"],["formControlName","device","placeholder","Select a device","field","device",3,"suggestions","dropdown","completeMethod","onSelect"],[1,"grid"],[1,"col-12"],[1,"card"],[1,"text-500","mb-3"],["formGroupName","rainfall"],["formControlName","start_date"],[1,"mt-3"],[3,"chartDT"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0)(1,"form",1)(2,"p-autoComplete",2),a.NdJ("completeMethod",function(n){return t.filterDevice(n)})("onSelect",function(){return t.setDevice()}),a.qZA()()(),a.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"h5"),a._uU(7,"Rainfall"),a.qZA(),a.TgZ(8,"p",6),a._uU(9,"Graphical representation of rainfall analytics"),a.qZA(),a.TgZ(10,"form",1)(11,"div",7),a._UZ(12,"date-calendar",8),a.qZA()(),a.TgZ(13,"div",9),a._UZ(14,"apex-chart-core",10),a.ALo(15,"chartDTFormater"),a.qZA()()()()),2&e&&(a.xp6(1),a.Q6J("formGroup",t.device_form),a.xp6(1),a.Q6J("suggestions",t.filtered_device)("dropdown",!0),a.xp6(8),a.Q6J("formGroup",t.graph_date_form),a.xp6(4),a.Q6J("chartDT",a.xi3(15,5,t.md_rainfall,"rainfall")))},styles:["[_nghost-%COMP%]     .p-autocomplete .p-autocomplete-input{padding:.5rem .75rem;border:1px solid #dee2e6;border-radius:6px;background:#ffffff;font-size:14px;transition:border-color .2s}[_nghost-%COMP%]     .p-autocomplete .p-autocomplete-input:hover{border-color:#6c757d}[_nghost-%COMP%]     .p-autocomplete .p-autocomplete-input:focus{border-color:#007bff;outline:none;box-shadow:0 0 0 .2rem #007bff40}[_nghost-%COMP%]     .p-autocomplete .p-autocomplete-dropdown{background:#007bff;color:#fff;border-radius:0 6px 6px 0}[_nghost-%COMP%]     .apexcharts-canvas{border-radius:4px}.graphical-view-container[_ngcontent-%COMP%]{padding:1rem}.card[_ngcontent-%COMP%]{margin-bottom:1rem}.card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#495057;font-weight:600;margin-bottom:.5rem}.card[_ngcontent-%COMP%]   .text-500[_ngcontent-%COMP%]{color:#6c757d;font-size:.875rem}form[_ngcontent-%COMP%]{margin-bottom:1rem}@media (max-width: 768px){.graphical-view-container[_ngcontent-%COMP%]{padding:.5rem}.card[_ngcontent-%COMP%]{margin-bottom:.75rem}}"]}),s})();var v=d(3557),_=d(7327),u=d(6760);let C=(()=>{var r;class s{constructor(e){this.ngControl=e,e.valueAccessor=this}writeValue(e){}registerOnChange(e){}registerOnTouched(e){}setDisabledState(e){}}return(r=s).\u0275fac=function(e){return new(e||r)(a.Y36(o.a5,2))},r.\u0275cmp=a.Xpm({type:r,selectors:[["date-calendar"]],decls:1,vars:3,consts:[["dateFormat","dd-mm-yy","inputId","start_date",3,"formControl","appendTo","showIcon"]],template:function(e,t){1&e&&a._UZ(0,"p-calendar",0),2&e&&a.Q6J("formControl",t.ngControl.control)("appendTo","body")("showIcon",!0)},dependencies:[o.JJ,o.oH,u.f]}),s})();var g=d(6903);const w=["chart"];let y=(()=>{var r;class s{get chartDT(){return this.__chartDT}set chartDT(e){this.__chartDT=e,this.series=e.length>0?e:[],this.initChartData()}constructor(){this.__chartDT=[],this.fill={type:["gradient","solid","solid"],colors:["#4338CA","#e20808"],gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.9,stops:[0,90,100]}},this.series=[],this.stroke={curve:["straight","smooth","monotoneCubic","stepline"],width:[2,2],colors:["#4338CA","#e20808"]},this.dataLabels={style:{fontSize:"20"}},this.markers={colors:["#4338CA","#e20808"]},this.grid={show:!1},this.legend={fontFamily:'Inter, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji',fontSize:"10",fontWeight:600,position:"bottom",labels:{colors:["#4338CA","#e20808"],useSeriesColors:!1},markers:{fillColors:["#4338CA","#e20808"]},itemMargin:{horizontal:10,vertical:5}}}ngOnInit(){}initChartData(){this.chart_dtls={width:"100%",type:"line",stacked:!1,height:350,toolbar:{show:!1}},this.dataLabels={enabled:!1},this.title={text:"",align:"center"},this.yaxis={crosshairs:{show:!0},labels:{style:{colors:"gray",fontSize:"10",fontWeight:600,fontFamily:'Inter, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji'}},title:{text:"",style:{fontSize:"15",fontWeight:600,fontFamily:'Inter, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji'}}},this.xaxis={axisTicks:{show:!0},crosshairs:{show:!0},type:"datetime",labels:{format:"HH:mm",datetimeUTC:!1,style:{colors:"gray",fontSize:"10",fontWeight:600,fontFamily:'Inter, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji'}},tooltip:{style:{fontFamily:'Inter, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji',fontSize:"10"}}},this.toolTip={style:{fontSize:"8",fontFamily:'Inter, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji'},marker:{fillColors:["#4338CA","#e20808"]},fixed:{enabled:!1,position:"topRight"},x:{show:!0,format:"dd/MM/yyyy HH:mm"},onDatasetHover:{highlightDataSeries:!0}}}}return(r=s).\u0275fac=function(e){return new(e||r)},r.\u0275cmp=a.Xpm({type:r,selectors:[["apex-chart-core"]],viewQuery:function(e,t){if(1&e&&a.Gf(w,5),2&e){let i;a.iGM(i=a.CRH())&&(t.chart=i.first)}},inputs:{chartDT:"chartDT"},decls:1,vars:13,consts:[[3,"series","chart","xaxis","stroke","colors","dataLabels","legend","markers","grid","yaxis","title","tooltip","responsive"]],template:function(e,t){1&e&&a._UZ(0,"apx-chart",0),2&e&&a.Q6J("series",t.series)("chart",t.chart_dtls)("xaxis",t.xaxis)("stroke",t.stroke)("colors",t.colors)("dataLabels",t.dataLabels)("legend",t.legend)("markers",t.markers)("grid",t.grid)("yaxis",t.yaxis)("title",t.title)("tooltip",t.toolTip)("responsive",t.responsive)},dependencies:[g.x]}),s})(),b=(()=>{var r;class s{constructor(){this.getOthersData=(e,t)=>[{name:t.replace("_"," ").toUpperCase(),data:e.reverse().map(n=>[new Date(n.date_time).getTime(),n[t]])}]}transform(e,...t){return"rainfall"===t[0]?this.getRainfallData(e):this.getOthersData(e,t[0])}getRainfallData(e){return[{name:"RAINFALL",data:e.map(n=>[new Date(n.date_time).getTime(),n.rainfall])}]}}return(r=s).\u0275fac=function(e){return new(e||r)},r.\u0275pipe=a.Yjl({name:"chartDTFormater",type:r,pure:!0}),s})();const S=[{path:"",component:m}];let D=(()=>{var r;class s{}return(r=s).\u0275fac=function(e){return new(e||r)},r.\u0275mod=a.oAB({type:r}),r.\u0275inj=a.cJS({providers:[p.uU],imports:[p.ez,v.Bz.forChild(S),o.u5,o.UX,_.WN,u._8,g.X]}),s})();a.B6R(m,function(){return[o._Y,o.JJ,o.JL,o.sg,o.u,o.x0,_.Qc,C,y]},function(){return[b]})}}]);